
[mcu mmboard]
serial: /dev/serial/by-id/usb-1a86_USB2.0-Serial-if00-port0 

# [printer]
# kinematics:none

[respond]
default_type: command

# MKS Gen l V1

[manual_stepper my_custom_stepper]
step_pin: mmboard:PF0
dir_pin: !mmboard:PF1
enable_pin: !mmboard:PD7
microsteps: 16
rotation_distance: 40   # Update this based on your leadscrew or belt setup

[tmc2208 my_custom_stepper]
uart_pin: PK1
interpolate: True
run_current: 0.8
# hold_current: 0.5  # Uncomment and set if needed
sense_resistor: 0.110
stealthchop_threshold: 999999
diag_pin: ^PE5  # Set to MCU pin connected to TMC DIAG pin
driver_SGTHRS: 60  # 255 is most sensitive value, 0 is least sensitive

[stepper_y]
step_pin: mmboard:PF6
dir_pin: !mmboard:PF7
enable_pin: !mmboard:PF2
microsteps: 16
rotation_distance: 40
homing_speed: 30

[stepper_z]
step_pin: mmboard:PL3
dir_pin: mmboard:PL1
enable_pin: !mmboard:PK0
microsteps: 16
rotation_distance: 8

[extruder]
step_pin: mmboard:PA4
dir_pin: !mmboard:PA6
enable_pin: !mmboard:PA2
microsteps: 16
rotation_distance: 33.500

[gcode_macro drive_custom_stepper]
description: Drive the custom stepper motor 100 mm forward and back
gcode:
    # Enable the custom stepper motor
    SET_PIN PIN=PD7 VALUE=0
    # Set the current position as zero
    MANUAL_STEPPER STEPPER=my_custom_stepper SET_POSITION=0
    # Move the custom stepper motor 100 mm forward at a speed of 3000 mm/min
    MANUAL_STEPPER STEPPER=my_custom_stepper MOVE=100 SPEED=1
    # Move the custom stepper motor back to the original position
    MANUAL_STEPPER STEPPER=my_custom_stepper MOVE=-100 SPEED=1
    # Disable the custom stepper motor
    SET_PIN PIN=PD7 VALUE=1
